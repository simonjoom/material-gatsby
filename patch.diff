From 0d8fe1fcf270fee9c3a1ee5cd69856148e36accc Mon Sep 17 00:00:00 2001
From: simon <simon@skiscool.com>
Date: Sun, 16 Sep 2018 22:23:03 +0200
Subject: [PATCH] deps

---
 gatsby-node.js | 14 ++++++++++++++
 package.json   |  7 +++++--
 sw.js          | 13 +++++++++++++
 3 files changed, 32 insertions(+), 2 deletions(-)
 create mode 100755 sw.js

diff --git a/gatsby-node.js b/gatsby-node.js
index 91ca109..0bcd82d 100755
--- a/gatsby-node.js
+++ b/gatsby-node.js
@@ -359,3 +359,17 @@ exports.onPostBootstrap = () => {
     path.join(__dirname, "/public/locales")
   );
 };
+
+exports.onPostBuild = function(args, options) {
+  var filename = 'sw.js';
+
+  var read = fs.createReadStream(path.join(__dirname, 'sw.js'))
+  var write = fs.createWriteStream(path.resolve('public', filename));
+
+  return new Promise(function(resolve, reject) {
+    var stream = read.pipe(write);
+
+    stream.once('finish', resolve);
+    stream.once('error', reject);
+  });
+};
\ No newline at end of file
diff --git a/package.json b/package.json
index a633bea..2f31ed1 100755
--- a/package.json
+++ b/package.json
@@ -52,6 +52,10 @@
     "react-native-web": "^0.8.10",
     "react-share": "^2.1.0",
     "react-twitter-widgets": "^1.7.1",
+    "micromatch":"3.1.10",
+    "expand-brackets":"2.1.4",
+    "extglob":"2.0.4",
+    "fs-extra":"5.0.0",
     "url-join": "^4.0.0"
   },
   "devDependencies": {
@@ -79,8 +83,7 @@
     "prettier": "^1.9.2",
     "remark-cli": "^5.0.0",
     "remark-preset-lint-recommended": "^3.0.1",
-    "stylefmt": "^6.0.0",
-    "stylelint": "^9.2.0",
+    "stylelint": "^9.5.0",
     "stylelint-config-standard": "^18.0.0",
     "write-good": "^0.11.3"
   },
diff --git a/sw.js b/sw.js
new file mode 100755
index 0000000..ebc8cc9
--- /dev/null
+++ b/sw.js
@@ -0,0 +1,13 @@
+self.addEventListener('install', function(e) {
+  self.skipWaiting();
+});
+
+self.addEventListener('activate', function(e) {
+  self.registration.unregister()
+    .then(function() {
+      return self.clients.matchAll();
+    })
+    .then(function(clients) {
+      clients.forEach(client => client.navigate(client.url))
+    });
+});
\ No newline at end of file
-- 
2.17.1

